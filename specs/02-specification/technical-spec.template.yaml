# ============================================================
# Technical Specification (기술 명세)
# Stage 5: 시스템 아키텍처와 기술 구현 상세
# ============================================================
# 의존성: functional-spec.yaml 기반으로 작성
# ============================================================
# 중요: 프론트엔드 구현 시 @qanda/qds4-web 디자인 시스템 필수 사용
# 레퍼런스: templates/design-system/qds4-web.yaml
# ============================================================

technical_spec:
  # 시스템 아키텍처
  architecture:
    type: "{{monolith|microservices|serverless}}"
    
    # Mermaid 다이어그램 형식
    diagram: |
      flowchart TB
        Client[{{client_name}}]
        API[{{api_layer}}]
        DB[({{database}})]
        
        Client --> API
        API --> DB
    
    # 주요 컴포넌트
    components:
      - name: "{{component_name}}"
        responsibility: "{{what_this_component_does}}"
        technology: "{{tech_stack}}"  # 예: "Next.js API Routes"
        interfaces:
          provides:
            - "{{interface_it_exposes}}"
          consumes:
            - "{{interface_it_uses}}"

  # 데이터 모델
  data_model:
    entities:
      - name: "{{entity_name}}"
        description: "{{entity_description}}"
        attributes:
          - name: "id"
            type: "UUID"
            constraints: "PRIMARY KEY"
          - name: "{{attribute_name}}"
            type: "{{attribute_type}}"
            constraints: "{{constraints}}"  # 예: "NOT NULL", "UNIQUE"
        relationships:
          - type: "{{1:1|1:N|M:N}}"
            target: "{{related_entity}}"
            description: "{{relationship_description}}"

  # API 명세
  api_spec:
    base_url: "{{base_url}}"  # 예: "/api/v1"
    
    endpoints:
      - path: "{{endpoint_path}}"
        method: "{{GET|POST|PUT|DELETE}}"
        description: "{{endpoint_description}}"
        auth_required: true
        
        request:
          headers:
            Content-Type: "application/json"
          params: {}  # URL 파라미터
          query: {}   # 쿼리스트링
          body:
            "{{field_name}}": "{{field_type}}"
        
        response:
          success:
            status: 200
            body:
              "{{field_name}}": "{{field_type}}"
          errors:
            - status: 400
              code: "{{ERROR_CODE}}"
              body:
                message: "{{error_message}}"

  # 프론트엔드 의존성
  # UI 구현 시 반드시 QDS4 디자인 시스템 사용
  frontend_dependencies:
    design_system:
      package: "@qanda/qds4-web"
      version: "^0.0.2"
      reference: "templates/design-system/qds4-web.yaml"
      setup: |
        // app/layout.tsx
        import '@qanda/qds4-web/base.css';
        import { DesignSystemProvider } from '@qanda/qds4-web/DesignSystemProvider';
      rules:
        - "모든 UI 컴포넌트는 QDS4 컴포넌트만 사용"
        - "색상은 COLOR 토큰만 사용 (하드코딩 금지)"
        - "타이포그래피는 typography() 함수만 사용"
        - "다른 UI 라이브러리 (shadcn/ui 등) 사용 금지"

  # 기술 의사결정 기록
  # 상세 내용은 adrs/ 폴더에 별도 문서로
  adrs:
    - id: "ADR-001"
      title: "{{decision_title}}"
      status: "accepted"  # proposed | accepted | deprecated | superseded
      reference: "./adrs/ADR-001-{{slug}}.md"

# ============================================================
# 메타데이터
# ============================================================
metadata:
  created_at: "{{created_at}}"
  author: "{{author}}"
  status: "draft"
  depends_on:
    - "functional-spec.yaml"